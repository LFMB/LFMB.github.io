--- 
layout: default
title: Home
order: 1
permalink: /
---
<!-- <script src="https://openfin.github.io/fin-hypergrid/build/fin-hypergrid.js"></script> -->
<script src="http://d3js.org/d3.v3.min.js"></script>
<div class="home">
    <section class="container-fluid hero-banner">
        <div class="intro-text">
            <h2 class="name">{{ site.title }}</h2>
            <p class="hero-tagline">{{ site.description }}</p>
        </div>
    </section>
    <!-- hypergrid chart - it's just too vertical to be useful
    <section class="state-of-union">
        <div id="state-of-union-grid"></div>
    </section>
    -->
    <section class="usa-map-container">
        <h2 class="state-of-union-map-title">State of the Union</h2>
        <p>The following will be a state by state general economic background</p>
        <div id="usa-map">
        </div>
    </section>
</div>
<!-- 
<script src="../scripts/state-of-union-data.js"></script>
<script>

var grid = new fin.Hypergrid('#state-of-union-grid', {
    data: perCapitaDif
    //data: formatedPerCapitaDif
});

grid.addProperties({
    showRowNumbers: false,
    showFilterRow: true,
    backgroundColor: 'rgb(255,255,255)',
    useHiDPI: true,
    gridLinesH: true,
    gridLinesV: true,
    color: 'rgb(0,0,0)',
    columnAutosizing: false,
    headerTextWrapping: false,
    multipleSelections: true,
    defaultColumnWidth: 100
});
</script>
-->
<script type="text/javascript">
const containerWidth = document.querySelector('.usa-map-container').clientWidth;
console.log(containerWidth);

var width = 960;
var height = 500;

window.data = {};

var projection = d3.geo.albersUsa()
    .translate([width / 2, height / 2])
    .scale([1000]); // scale things down so see entire US

var path = d3.geo.path().projection(projection);

// Define linear scale for output
var color = d3.scale.linear()
    .range(["rgb(255,0,0)", "rgb(0,128,0)"]);

var legendText = ["Cities Lived", "States Lived", "States Visited", "Nada"];

//Create SVG element and append map to the SVG
var svg = d3.select("#usa-map")
    .append("svg")
    .attr("width", width)
    .attr("height", height);

// Append Div for tooltip to SVG
var div = d3.select("#usa-map")
    .append("div")
    .attr("class", "tooltip")
    .style("opacity", 0);

// Load in my states data!
d3.json("data/per-capita-gdp.json", function(data) {


    var max2015q1 = d3.max(data.states, function(d) {
        return d["2015-Q1"]
    });
    var min2015q1 = d3.min(data.states, function(d) {
        return d["2015-Q1"]
    });


    color.domain([min2015q1, max2015q1]);


    // Load GeoJSON data and merge with states data
    d3.json("data/us-states.json", function(json) {
        var dataState,
            dataValue,
            jsonState,
            jsonData;

        let stateName = '',
            stateDiff = 0;

        window.data.usaMap = json;
        window.data.usaGdp = data;

        function filterByPropertiesName(obj) {
            if (obj.properties.name === stateName) {
                obj.properties.diff = stateDiff;
            }
        }

        // filtered gdp and state name array of objects
        const q1GDP2015 = window.data.usaGdp.states.map(state => ({
            gdpDif: state["2015-Q1"],
            state: state.state
        }));


        for (let a = 0; a < q1GDP2015.length; a++) {
            stateName = q1GDP2015[a]['state'];
            stateDiff = q1GDP2015[a]['gdpDif'];

            

            json.features.filter(filterByPropertiesName);

        }

        

        // Bind the data to the SVG and create one path per GeoJSON feature
        svg.selectAll("path")
            .data(json.features)
            .enter()
            .append("path")
            .attr("d", path)
            .style("stroke", "#000")
            .style("stroke-width", "1")
            .style("fill", function(d) {

                // Get data value
                var value = d.properties["diff"];

                if (value) {
                    //If value exists…
                    return color(value);
                } else {
                    //If value is undefined…
                   return "rgb(213,222,217)";
                }
               
            });



        // Modified Legend Code from Mike Bostock: http://bl.ocks.org/mbostock/3888852
        /*
        var legend = d3.select("#usa-map").append("svg")
            .attr("class", "legend")
            .attr("width", 140)
            .attr("height", 200)
            .selectAll("g")
            .data(color.domain().slice().reverse())
            .enter()
            .append("g")
            .attr("transform", function(d, i) {
                return "translate(0," + i * 20 + ")";
            });

        legend.append("rect")
            .attr("width", 18)
            .attr("height", 18)
            .style("fill", color);

        legend.append("text")
            .data(legendText)
            .attr("x", 24)
            .attr("y", 9)
            .attr("dy", ".35em")
            .text(function(d) {
                return d;
            });
        */
    });

});
</script>
